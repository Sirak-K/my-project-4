<!-- File: user_profile.html -->

{% extends 'base.html' %}



{% block content_profile_details %}

{% include 'header_logged_in.html' %}

<!-- PROFILE -->


  <!-- Profile Images Section -->
<div class="profile-images-section">



  <!-- PROFILE BANNER  -->
      {% if user.profile.banner_image %}
        <a href="{% url 'user_profile_image' %}">
          <img class="profile-banner" src="{{ user.profile.banner_image.url }}" alt="{{ user.first_name }} {{ user.last_name }}'s profile banner image">
        </a>
      {% else %}
        <a href="{% url 'user_profile_image' %}">
          <img class="profile-banner" src="/media/img/default_banner_image.png" alt="{{ user.first_name }} {{ user.last_name }}'s profile banner image">
        </a>
      {% endif %}



  <!-- PROFILE IMAGE -->
      {% if user.profile.profile_image %}
          <a href="{% url 'user_profile_image' %}">
            <img class="profile-image" src="{{ user.profile.profile_image.url }}" alt="{{ user.first_name }} {{ user.last_name }}'s profile image">
          </a>
        {% else %}
          <a href="{% url 'user_profile_image' %}">
            <img class="profile-image" src="/media/img/default_profile_image.png" alt="{{ user.first_name }} {{ user.last_name }}'s profile image">
          </a>
        {% endif %}

  </div>
  


  <div class="profile-container">
    
    <!-- PROFILE DETAILS -->

    <h3 class="profile-detail-header" >{{ user.first_name }} {{ user.last_name }}</h3>

  <section class="profile-details-section">
    

      <div class="profile-details" data-user-id="{{ user.id }}">

<!-- -------------- Friendship --------------  -->




{% if friend_request_status == 'not_friends' %}
    <button class="add-friend-btn" type="button">Add Friend</button>
{% elif friend_request_status == 'pending' %}
    <button class="cancel-friend-btn" type="button">Cancel Pending Friend Request</button>
{% elif friend_request_status == 'friends' %}
    <button class="unfriend-btn" type="button">Unfriend</button>
{% endif %}




<!-- DEFAULT BUTTON STATE WHEN A NEW USER IS CREATED I.E 
  IF VISITOR OF PROFILE HAS NO FRIENDSHIP WITH THE VISITED PROFILES' USER, 
SHOW BUTTON AS "ADD FRIEND"-->


<!-- IF A SENT FRIEND REQUEST IS AWAITING ACCEPTANCE/REJECTION, 
  SHOW BUTTON AS "CANCEL PENDING REQUEST" FOR THE SENDER OF THE REQUEST -->

  

<!-- IF THE TWO USERS ARE FRIENDS, 
  SHOW BUTTON AS "UNFRIEND" ON BOTH FRIENDS' PROFILES WHEN THEY VISIT EACHOTHERS PROFILES
AS FRIENDS -->





    <!-- BIO -->
    <div class="profile-detail-bio">
      <span class="bio-label">Bio:</span>
      <span class="bio-text" data-field-name="bio" contenteditable>{{ user_profile.bio }}</span>
    
        <!-- BIO - EDIT -->
        <span class="edit-pencil-container">
          <a href="#" class="edit-pencil-bio">&#9998;</a>
      </span>
    </div>

      
    <!-- GENDER -->
    <div class="profile-detail-gender">
      <span class="gender-label">Gender: </span>
      <span class="gender-text" data-field-name="gender">{{ user_profile.get_gender_display }}</span>
      
      <!-- GENDER - EDIT -->
      <span class="edit-pencil-container">
        <a href="#" class="edit-pencil" data-field-selector="[data-field-name='gender']">&#9998;</a>
        <div class="dropdown-menu" data-field-name="gender">
          {% for value, display_name in user_profile.GENDER_CHOICES %}
            <a href="#" data-value="{{ value }}">{{ display_name }}</a>
          {% endfor %}
        </div>
      </span>
    </div>


      <!-- PROFESSION -->
      <div class="profile-detail-profession">
        <span class="profession-label">Profession:</span>
        <span class="profession-text" data-field-name="profession">{{ user_profile.get_profession_display }}</span>
        <!-- PROFESSION - EDIT -->
        <span class="edit-pencil-container">
          <a href="#" class="edit-pencil" data-field-selector="[data-field-name='profession']">&#9998;</a>
          <div class="dropdown-menu" data-field-name="profession">
            {% for value, display_name in user_profile.PROFESSION_CHOICES %}
              <a href="#" data-value="{{ value }}">{{ display_name }}</a>
            {% endfor %}
          </div>
        </span>
      </div>


    </div>
  </section>


</div>




<!-- CODE SECTION - CREATE NEW POST -->
<section id="post-create-section">
  <form class="post-create-form" method="post" action="{% url 'post_create' %}">
    {% csrf_token %}

  
        <label for="post_title"></label>
        <input class="post-create-title" placeholder="Post Title" type="text" id="post_title" name="post_title"  required>
  

        <label for="post_content"></label>
        <textarea class="post-create-text" name="post_content" placeholder="How are you feeling today, 
{{ user.first_name }}?" required></textarea>


    <button type="submit" class="post-create-btn">Create Post</button>
    
  </form> 
</section>

{% endblock content_profile_details %}

{% block content_post_section %}

<!-- DISPLAY POSTS -->
{% for post in all_posts %}
{% include 'post_list.html' with post=post all_post_comments=all_post_comments %}
{% endfor %}
{% endblock content_post_section %}



